---
title: "Лабораториска вежба бр. 2 (Симулации на познати распределби)"
output: html_notebook
editor_options:
chunk_output_type: inline
---

### Опис

Во оваа лабораториска вежба ќе се запознаеме со симулација на познати распределби во програмскиот јазик `R`.

#### Концепти кои ќе ги опфатиме во оваа вежба:
- Запознавање со функции во R поврзани со случајни распределби
- Распределби од дискретен тип
- Распределби од апсолутно непрекинат тип
- Задачи поврзани со распределби од дискретен и апсолутно непрекинат тип

Функции во R кои се поврзани со случајни распределби се од облик <i>rname, pname, qname,
dname</i>, каде name е името во R за конкретната распределба. Имињата се дадени во
следната табела. Секоја од наредбите се повикува со карактеристични параметри.

Во R, различните распределби имаат четири главни типови на функции:

- **`rname()`** – Се користи за генерирање на случајни броеви од дадената распределба.
- **`pname()`** – Ја дава вредноста на функцијата на распределба во дадена точка, односно плоштината под густината на распределбата лево од дадената точка.
- **`qname()`** – Го дава бараниот квантил за дадената распределба.
- **`dname()`** – Се користи за исцртување на теоретската густина на распределбата.

Следната табела ги прикажува функциите за различни распределби во R:

| Распределба       | Генерирање (`rname`) | Функција на распределба (`pname`) | Квантилна функција (`qname`) | Густина/Закон на распределба (`dname`) |
|-------------------|----------------------|----------------------------------|------------------------------|----------------------------------------|
| Binomial          | `rbinom()`           | `pbinom()`                       | `qbinom()`                   | `dbinom()`                             |
| Poisson           | `rpois()`            | `ppois()`                        | `qpois()`                    | `dpois()`                              |
| Geometric         | `rgeom()`            | `pgeom()`                        | `qgeom()`                    | `dgeom()`                              |
| Hipergeometric    | `rhyper()`           | `phyper()`                       | `qhyper()`                   | `dhyper()`                             |
| Exponential       | `rexp()`             | `pexp()`                         | `qexp()`                     | `dexp()`                               |
| Gamma             | `rgamma()`           | `pgamma()`                       | `qgamma()`                   | `dgamma()`                             |
| Negative Binomial | `rnbinom()`          | `pnbinom()`                      | `qnbinom()`                  | `dnbinom()`                            |
| Normal            | `rnorm()`            | `pnorm()`                        | `qnorm()`                    | `dnorm()`                              |
| Log-normal        | `rlnorm()`           | `plnorm()`                       | `qlnorm()`                   | `dlnorm()`                             |
| Chi square        | `rchisq()`           | `pchisq()`                       | `qchisq()`                   | `dchisq()`                             |
| Student (t)       | `rt()`               | `pt()`                           | `qt()`                       | `dt()`                                 |
| Uniform           | `runif()`            | `punif()`                        | `qunif()`                    | `dunif()`                              |

Со овие функции, можеш да работиш со различни распределби за симулација, пресметка на веројатности, квантилни вредности, и визуелизација на густината на распределбите.


##
<hr>
## Распределби од дискретен тип
<hr>
## Индикатор на настан A или Бернулиева распределба

Индикаторот на настанот `А` или Бернулиева распределба претставува случајна променлива која прима вредност 1 ако настанот `А` се појави и вредност 0 ако не се појави. На пример, ако настанот `А` е „фрлање на паричка и појава на глава,“ тогаш индикаторот ќе биде 1 ако се појави глава и 0 ако се појави писмо.

### Дефиниција на Бернулиева распределба

**Бернулиевата распределба** се користи за моделирање на настани кои имаат два можни исхода. Случајната променлива `X` има Бернулиева распределба ако прима вредност `1` со веројатност `p` и вредност `0` со веројатност `1-p`, каде што `p` е веројатноста за успех. Ова се означува како `X ~ B(1, p)`. Во секој обид, настанот се појавува со еднаква веројатност без разлика на останатите обиди.

### Формула на Бернулиевата распределба

Функцијата за веројатност на Бернулиевата распределба е дадена со:

\[
P(X = x) =
\begin{cases}
p, & \text{за} \; x = 1\\
1 - p, & \text{за} \; x = 0
\end{cases}
\]

каде што `p` е параметарот на распределбата кој претставува веројатноста за успех.

### Пример во R

Во R, симулацијата на Бернулиева распределба се врши со функцијата `rbinom()`, која генерира случајни броеви кои следат биномна распределба, со `size = 1` за Бернулиевата распределба.
```{r}
#rbinom(n, size, prob)
```
### Опис на параметрите:

- **`n`**: Број на случајни броеви кои треба да се генерираат. Овој параметар ја одредува големината на симулираниот примерок. На пример, ако `n = 1000`, функцијата ќе генерира 1000 случајни броеви кои следат биномна распределба.

- **`size`**: Број на обиди во секоја симулација. Бидејќи биномната распределба брои број на успеси во фиксни број на обиди, овој параметар ја одредува големината на тие обиди. За Бернулиевата распределба, секој настан има само еден обид, па затоа се поставува `size = 1`. Тоа значи дека функцијата брои дали има успех (1) или неуспех (0) во еден обид.

- **`prob`**: Веројатноста за успех во секој обид. Ова е параметарот `p`, кој го дефинира исходот на секој поединечен обид. На пример, ако `prob = 0.5`, тоа значи дека веројатноста за успех е 50%.

```{r}
# Поставување на параметрите
n <- 1000  # Број на симулации
p <- 0.5   # Веројатност за успех

# Симулација на Бернулиева распределба
bernoulli_samples <- rbinom(n, size = 1, prob = p)

# Преглед на првите 10 симулации
head(bernoulli_samples, 10)
```

### Визуелизација на резултатите

За визуелизација на распределбата може да се користи `ggplot2` за да се прикаже фреквенцијата на исходите.

```{r}
# Симулација на Бернулиева распределба
set.seed(0)
n <- 1000     # Број на симулации
p <- 0.7      # Веројатност за успех

bernoulli_samples <- rbinom(n, size = 1, prob = p)

# Визуелизација со hist()
hist(bernoulli_samples, breaks = seq(-0.5, 1.5, by = 1), col = "lightblue",
     main = "Симулација на Бернулиева распределба",
     xlab = "Исход", ylab = "Фреквенција", xaxt = "n")
axis(1, at = c(0, 1), labels = c("0", "1"))

```

## Биномна распределба

### Дефиниција на биномна распределба

Биномната распределба ја опишува веројатноста за одреден број на успеси во фиксен број на независни обиди, при што секој обид има две можни исходи: успех или неуспех. Случајната променлива `X` има биномна распределба ако брои колку пати се случил успех во `n` независни обиди, каде што `p` е веројатноста за успех во еден обид. Ова се означува како `X ~ B(n, p)`.

### Формула на биномната распределба

Функцијата за веројатност на биномната распределба е дадена со:

\[
P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}
\]

каде што:
- `n` е бројот на обиди,
- `k` е бројот на успеси,
- `p` е веројатноста за успех во еден обид.

### Пример за симулација во R

Во R, биномната распределба може да се симулира со функцијата `rbinom()`, која генерира случајни броеви кои следат биномна распределба.

#### Опис на `rbinom(n, size, prob)`:
- **`n`**: Број на случајни броеви кои треба да се генерираат.
- **`size`**: Број на обиди за секоја симулација.
- **`prob`**: Веројатност за успех во еден обид.

### Пример
Нека имаме неисправна коцка која се фрла 100 пати, и се брои колку пати ќе се падне шестка. Овој експеримент се повторува 10 пати. Веројатноста да се падне шестка во едно фрлање на оваа коцка е 0.1. Да се направи симулација на овој експеримент и да се нацрта хистограм на фреквенциите.

```{r}
# Симулирање на експериментот
set.seed(0)
N <- 10      # Број на повторувања на експериментот
n <- 100     # Број на фрлања
p <- 0.1     # Веројатност за успех (да се падне шестка)

# Генерирање на податоци од биномна распределба
x <- rbinom(N, size = n, prob = p)

# Преглед на симулираните резултати
print(x)

# Визуелизација со хистограм
hist(x, freq = TRUE, col = "lightblue",
     main = "Симулација на биномна распределба",
     xlab = "Број на успеси (шестки)",
     ylab = "Фреквенција")
```

### Реализации
Некои можни резултати од симулацијата може да бидат:
- Прва реализација: `11, 10, 11, 9, 7, 10, 12, 12, 13, 14`
- Втора реализација: `3, 13, 6, 15, 16, 9, 12, 12, 12, 13`

## Рамномерна распределба на конечно множество

Кога имаме случајна променлива која прима вредности од конечно множество, искажаната веројатност е рамномерна кога сите вредности имаат иста веројатност да се појават. Оваа распределба е особено корисна во ситуации каде што сакаме да избереме случаен елемент од низа или множество.

#### Дефиниција на рамномерна распределба на конечно множество

Ако имаме случајна променлива \( X \) која може да прима \( n \) различни вредности \( x_1, x_2, \ldots, x_n \), тогаш \( X \) следи рамномерна распределба ако:

\[ P(X = x_i) = \frac{1}{n}, \quad \text{за} \; i = 1, 2, \ldots, n \]

Ова значи дека секоја вредност во множеството има иста веројатност да биде избрана.

### Пример за симулација во R

Во R, можеме да симулираме избор од конечно множество користејќи функцијата `sample()`, која ја симулира рамномерната распределба на дискретни вредности.

#### Опис на `sample()`
- **`x`**: Вектор на вредности од кои ќе се избира.
- **`size`**: Број на извлечени вредности.
- **`replace`**: Логичка вредност која одредува дали да се дозволи повторно извлекување на вредностите.

### Пример
Да симулираме 1000 извлекувања од конечно множество {1, 2, 3, 4, 5}.

```{r}
# Генерирање на случајни извлекувања од конечно множество
set.seed(0)
values <- 1:5   # Множеството од кое ќе се избира
n <- 1000       # Број на извлечени точки

# Извлекување на вредности
samples <- sample(values, size = n, replace = TRUE)

# Преглед на првите 10 извлечени вредности
head(samples, 10)

# Визуелизација со хистограм
barplot(table(samples), col = "lightblue",
        main = "Симулација на рамномерна распределба на конечно множество",
        xlab = "Вредности",
        ylab = "Фреквенција",
        ylim = c(0, max(table(samples)) + 50))
```

### Реализации
Во овој пример, симулираме 1000 извлекувања од множество {1, 2, 3, 4, 5}. Пошто е избрана рамномерна распределба, секоја од овие вредности има иста шанса да се појави. Барплотот прикажува фреквенции за секоја вредност во множеството, при што распределбата е приближно рамномерна.

## Хипергеометриска распределба

### Дефиниција на хипергеометриска распределба

Хипергеометриската распределба се применува во ситуации кога од конечен множество објекти се извлекуваат објекти без повторување. Нека во даденото множество од \( n \) различни објекти, \( m \) од нив поседуваат одредено својство \( A \) (при тоа, \( m < n \)).

Кога случајно се избираат \( k \) објекти (при тоа, \( k < n \)), нека \( X \) биде случајна променлива која ја претставува бројот на објекти од избраните \( k \) кои го поседуваат својството \( A \).

### Опсег на вредности

Опсегот на случајната променлива \( X \) е даден со:

\[
R_X = \{ \max(0, m + k - n), \ldots, \min(m, k) \}
\]

### Веројатност

Веројатноста за точно \( i \) успешни објекти, односно:

\[
p_i = P\{X = i\} = \frac{\binom{m}{i} \cdot \binom{n - m}{k - i}}{\binom{n}{k}}, \quad i \in R_X
\]

Каде:
- \( \binom{a}{b} \) е комбинирањето на \( a \) над \( b \).

Важно е да се напомене дека вкупната веројатност за сите можни вредности на \( X \) е 1:

\[
\sum_{i=0}^{k} p_i = 1
\]

### Пример за симулација во R

Во R, хипергеометриската распределба може да се симулира со функцијата `rhyper()`. Оваа функција генерира случајни броеви според хипергеометриската распределба.

#### Опис на `rhyper(nn, m, n, k)`:
- **`nn`**: Број на случајни броеви кои треба да се генерираат.
- **`m`**: Број на елементи кои поседуваат одредено својство А.
- **`n`**: Број на елементи кои не поседуваат одредено својство А.
- **`k`**: Број на извлечени елементи.

### Пример

Да симулираме 1000 извлекувања, каде имаме 20 бели топчиња и 30 црни топчиња, извлекувајќи 10.

```{r}
# Генерирање на случајни броеви од хипергеометриската распределба
set.seed(0)
m <- 20  # Број на бели топчиња
n <- 30  # Број на црни топчиња
k <- 10  # Број на извлечени топчиња
num_samples <- 1000  # Број на симулации

# Генерирање на податоци од хипергеометриската распределба
hyper_samples <- rhyper(num_samples, m, n, k)

# Преглед на првите 10 вредности
print(head(hyper_samples, 10))

# Визуелизација со хистограм
hist(hyper_samples, breaks = seq(-0.5, k + 0.5, by = 1), col = "lightgreen",
     main = "Симулација на хипергеометриска распределба",
     xlab = "Број на бели топчиња",
     ylab = "Фреквенција",
     xaxt = "n")
axis(1, at = 0:k)  # Додавање на ознаки на x-оската

```
<hr>
### Вежба 1
Во кутија имате вкупно 50 топчиња, од кои 20 се црвени и 30 се зелени. Од оваа кутија, случајно извлекувате 15 топчиња без враќање.

Дефинирајте ја случајната променлива
𝑋
како бројот на извлечени црвени топчиња.

Кои се параметрите на хипергеометриската распределба за оваа ситуација? Опишете го распонот.

Пресметајте ја веројатноста дека ќе извлечете точно 5 црвени топчиња.
```{r}
#Решавајте тука
# Параметри
N <- 50   # Вкупен број топчиња
K <- 20   # Број на црвени топчиња
n <- 15   # Број на извлечени топчиња
x <- 5    # Број на црвени топчиња што сакаме да ги извлечеме

# Пресметка на P(X = 5)
p_x_5 <- dhyper(x, K, N - K, n)
p_x_5

```

## Геометриска распределба

### Дефиниција на геометриска распределба

Геометриската распределба се применува за моделирање на бројот на експерименти до првото појавување на одреден настан \( A \). Овие експерименти се независни и секој експеримент има иста веројатност \( p \) за успех, додека веројатноста за неуспех е \( q = 1 - p \). Во секој обид, настанот се појавува со еднаква веројатност без разлика на останатите обиди.

Нека \( X \) биде случајна променлива која ја претставува бројот на експерименти до првото појавување на настанот \( A \). Опсегот на случајната променлива \( X \) е даден со:

\[
R_X = \{1, 2, 3, \ldots\}
\]

### Веројатност

Веројатноста за точно \( i \) извлечени експерименти, односно:

\[
p_i = P\{X = i\} = q^{i-1} p, \quad i \in R_X
\]

Каде:
\( q^{i-1} \) е веројатноста за \( i-1 \) неуспешни експерименти, и
\( p \) е веројатноста за успех во \( i \)-тиот експеримент.

Важно е да се напомене дека вкупната веројатност за сите можни вредности на \( X \) е 1:

\[
\sum_{i=1}^{+\infty} p_i = \frac{p}{1 - q} = 1
\]

### Дефиниција на геометриска распределба

За случајната променлива \( X \), велиме дека има геометриска распределба со параметар \( p \) и ја означуваме како \( X \sim \text{Geo}(p) \).

### Пример за симулација во R

<b>За геометриската распределба во R, треба да се нагласи дека R симулира број на неуспешни обиди до прв успех, а не вкупен број на експерименти до појава на прв успех како што е теоретската дефиниција на геометриска распределба</b>. Во овој пример, симулираме 1000 извлечени експерименти со веројатноста \( p = 0.3 \) за појавување на настанот \( A \).

```{r}
# Параметри на геометриската распределба
set.seed(0)
p <- 0.3  # Веројатност за успех
q <- 1 - p  # Веројатност за неуспех
num_samples <- 1000  # Број на симулирани извлечувања

# Генерирање на податоци од геометриската распределба
geo_samples <- rgeom(num_samples, prob = p) + 1  # rgeom() враќа 0 за првиот успех

# Преглед на првите 10 вредности
print(head(geo_samples, 10))

# Визуелизација со хистограм
hist(geo_samples, breaks = seq(0.5, max(geo_samples) + 0.5, by = 1), col = "lightblue",
     main = "Симулација на геометриска распределба",
     xlab = "Број на експерименти до успех",
     ylab = "Фреквенција",
     xaxt = "n")
axis(1, at = 1:max(geo_samples))  # Додавање на ознаки на x-оската
```
<hr>
### Вежба 2
Кај неисправна паричка веројатноста да се падне глава е 0.1. Паричката се фрла додека не се
падне глава. Нека Х е случајната променлива која го опишува
а) бројот на неуспеси се’ до првото појавување на глава,
б) бројот на фрлања се’ до првото појавување на глава.
Да се направи симулација за 50 вредности на Х. Да се нацрта хистограм.
```{r}
#Решавајте тука
# Параметар за веројатност на успех (глава)
p <- 0.1

# Број на симулации
n_sim <- 50

# Симулација за бројот на неуспеси до првата глава
x_failures <- rgeom(n_sim, prob = p) # Геометриска распределба

# Симулација за бројот на фрлања до првата глава
x_flips <- x_failures + 1

# Хистограм за бројот на неуспеси
hist(x_failures, main = "Хистограм на неуспеси пред првата глава",
     xlab = "Број на неуспеси", ylab = "Фреквенција", col = "lightblue", border = "black")

# Хистограм за бројот на фрлања
hist(x_flips, main = "Хистограм на бројот на фрлања до првата глава",
     xlab = "Број на фрлања", ylab = "Фреквенција", col = "lightgreen", border = "black")

```

## Негативна бинома распределба

**Дефиниција**

Негативната бинома распределба опишува ситуација во која се изведува серија од независни и идентични експерименти, се дури не се случи настанот \( A \) точно \( k \) пати. Нека \( p = P(A) \) биде веројатноста на настанот \( A \), а \( q = 1 - p \) биде веројатноста на неуспех. Во секој обид, настанот се појавува со еднаква веројатност без разлика на останатите обиди.

**Случајна променлива**

Нека \( X \) биде бројот на изведени експерименти до појавата на настанот \( A \) точно \( k \) пати. Потсетете се дека распонот на \( X \) е:

\[
R_X = \{ k, k + 1, k + 2, \ldots \}
\]

**Формула на веројатноста**

Веројатноста да се случи \( A \) точно \( k \) пати во \( n \) експерименти е дадена со:

\[
P(X = n) = \binom{n-1}{k-1} q^{n-k} p^k
\]

Овде, \( \binom{n-1}{k-1} \) се бројат начините на кои настанот \( A \) може да се појави \( k - 1 \) пати во првите \( n - 1 \) експерименти, а потоа да се појави во последниот (н-ти) експеримент.

**Случајна променлива**

Ако случајната променлива \( X \) има негативна бинома распределба со параметри \( k \) и \( p \), пишуваме:

\[
X \sim NB(k, p)
\]

### Пример за симулација во R

Претставете си дека имате веројатност \( p = 0.3 \) за успешен настан и сакате да ја симулирате негативната бинома распределба за \( k = 5 \) успеси. <b>Забележете дека во R, функцијата `rnbinom()` враќа број на неуспеси пред да се постигнат точно \( k \) успеси. Затоа, за да го добиеме вкупниот број на експерименти (кој треба да биде барем \( k \)), потребно е на секоја генерирана вредност да додадеме \( k \). </b>

```{r}
# Параметри
k <- 5  # Број на успеси
p <- 0.3  # Веројатноста за успешен настан

# Генерирање на негативно биномијални податоци
set.seed(0)
n_samples <- 1000
neg_binom_samples <- rnbinom(n_samples, size = k, prob = p) + k  # Додаваме k

# Преглед на првите 10 вредности
head(neg_binom_samples, 10)

# Визуелизација со хистограм
hist(neg_binom_samples, freq = TRUE, col = "lightgreen",
     main = "Симулација на негативна бинома распределба",
     xlab = "Број на експерименти",
     ylab = "Фреквенција",
     breaks = 30)
```
## Пуасонова распределба

**Дефиниција**

Случајната променлива \( X \) има Пуасонова распределба ако распонот на \( X \) е:

\[
R_X = \{0, 1, 2, \ldots\}
\]

Веројатноста да \( X \) има вредност \( i \) е дадена со формулата:

\[
P(X = i) = p_i = \frac{\lambda^i}{i!} e^{-\lambda}
\]

каде \( \lambda > 0 \) е дадена константа која претставува средниот број на настани во дадена единица време или простор.

**Сумата на веројатности**

Вкупната веројатност за сите можни вредности на \( X \) е:

\[
\sum_{i=0}^{\infty} p_i = \sum_{i=0}^{\infty} \frac{\lambda^i}{i!} e^{-\lambda} = e^{-\lambda} \sum_{i=0}^{\infty} \frac{\lambda^i}{i!} = e^{-\lambda} e^{\lambda} = 1
\]

Оваа равенство потврдува дека веројатностите \( p_i \) за \( i = 0, 1, 2, \ldots \) навистина дефинираат закон на распределба.

**Ознака**

Ако \( X \) има Пуасонова распределба, пишуваме:

\[
X \sim P(\lambda)
\]

**Интерпретација**

Пуасонова распределба се користи за моделирање на бројот на независни настани кои се појавуваат во фиксна единица време или простор. На пример, може да се користи за да се опише бројот на повици на телефонска централа во еден час или бројот на несреќи на одреден пат во еден ден.

### Пример за симулација во R

Да разгледаме пример во кој ќе симулираме Пуасонова распределба ако \( \lambda = 4 \) (што значи дека очекуваме 4 настани во единица време) и да генерираме 1000 извлекувања.

```{r}
# Параметри
lambda <- 4  # Просечен број на настани

# Генерирање на Пуасонова распределба
set.seed(0)
n_samples <- 1000
poisson_samples <- rpois(n_samples, lambda)

# Преглед на првите 10 вредности
head(poisson_samples, 10)

# Визуелизација со хистограм
hist(poisson_samples, freq = TRUE, col = "lightblue",
     main = "Симулација на Пуасонова распределба",
     xlab = "Број на настани",
     ylab = "Фреквенција",
     breaks = 20)
```
### Вежба 3
Во телефонската служба на компанијата XYZ, во просек, примаат 6 повици на час. Вработените сакаат да ја оценат веројатноста за различни бројки на повици во текот на следниот час, за да можат подобро да ја планираат својата работа.

Да се пресмета веројатноста дека ќе има: <br>

-Ниеден повик<br>
-Еден повик<br>
-Два повика<br>
-Три повика<br>
-Четири повика<br>
```{r}
#Решавајте тука
# Параметар за просечен број на повици
lambda <- 6

# Број на повици
k_values <- 0:4

# Пресметка на веројатностите
probabilities <- dpois(k_values, lambda)

# Печатење на резултатите
result <- data.frame(K = k_values, Probability = probabilities)
print(result)

```

<hr>
## Распределби од апсолутно-непрекинат тип
<hr>

## Рамномерна распределба на интервал \((a, b)\)

Случајната променлива \(X\) се вели дека има рамномерна распределба на интервалот \((a, b)\), ако нејзината густина на веројатност е константна на овој интервал и еднаква на 0 надвор од него. Оваа распределба се означува како \(X \sim U(a, b)\).

### Формула за густината на рамномерната распределба

Густината на веројатност за рамномерната распределба е дадена со:

\[
p(x) =
\begin{cases}
\frac{1}{b - a}, & a \leq x \leq b\\
0, & \text{инаку}
\end{cases}
\]

каде што:
- \(a\) и \(b\) се границите на интервалот на распределбата,
- \(\frac{1}{b - a}\) е константата која ја обезбедува нормализацијата на густината, односно вкупната површина под густината да биде 1.

### Определување на константата \(C\)

За да ја одредиме константата \(C\), ја користиме теоремата која вели дека вкупната површина под густината на веројатност мора да биде 1. Значи:

\[
1 = \int_{-\infty}^{+\infty} p(x) \, dx = \int_{a}^{b} C \, dx = C(b - a)
\]

Оттука, добиваме:

\[
C = \frac{1}{b - a}
\]

Па, густината на распределбата може да се запише како:

\[
p(x) =
\begin{cases}
\frac{1}{b - a}, & a \leq x \leq b\\
0, & \text{инаку}
\end{cases}
\]

### Пример во R
Еве пример за симулација на рамномерна распределба во R. Во овој пример ќе генерираме 1000 случајни броеви од рамномерната распределба на интервалот \([a, b] = [2, 5]\), и ќе ја визуелизираме распределбата со хистограм.

```{r}
# Генерирање на случајни броеви од рамномерната распределба
set.seed(0) # За репродуктивност
n <- 1000     # Број на симулирани вредности
a <- 2        # Долна граница на интервалот
b <- 5        # Горна граница на интервалот

# Симулирање на рамномерна распределба
uniform_samples <- runif(n, min = a, max = b)

# Преглед на првите 10 симулирани вредности
head(uniform_samples, 10)

# Визуелизација со хистограм
hist(uniform_samples, freq = TRUE, col = "lightblue",
     main = "Симулација на рамномерна распределба на интервалот (2, 5)",
     xlab = "Вредности", ylab = "Фреквенција", breaks = 20)
```

## Експоненцијална распределба

Случајната променлива \(X\) се вели дека има експоненцијална распределба со параметар \(\lambda\), и ова се означува како \(X \sim E(\lambda)\), ако нејзината густина на веројатност е зададена со:

\[
p(x) =
\begin{cases}
0, & x < 0 \\
\lambda e^{-\lambda x}, & x \geq 0
\end{cases}
\]

каде што \(\lambda > 0\) е параметарот на распределбата кој ја претставува стапката на појава на настаните.

### Интерпретација

Експоненцијалната распределба се користи за моделирање на времето помеѓу појавите на независни настани кои се случуваат со константна стапка. На пример, може да се користи за моделирање на времето помеѓу доаѓањата на клиентите во банка, времето помеѓу дефекти на машини, или времето до појавување на следен телефонски повик во телефонски центар.

## Пример за симулација во R

Во R, експоненцијалната распределба може да се симулира со функцијата `rexp()`, која генерира случајни броеви од експоненцијална распределба.

#### Опис на `rexp(n, rate)`:
- **`n`**: Број на случајни броеви кои треба да се генерираат.
- **`rate`**: Параметарот \(\lambda\) кој ја претставува стапката на појава на настаните.

### Пример
Да се генерираат 1000 случајни броеви од експоненцијална распределба со параметар \(\lambda = 2\) и да се нацрта хистограм на симулираните вредности.
```{r}
# Генерирање на случајни броеви од експоненцијална распределба
set.seed(0) # За репродуктивност
n <- 1000     # Број на симулирани точки
lambda <- 2   # Параметар на распределбата

# Симулирање на експоненцијална распределба
exp_samples <- rexp(n, rate = lambda)

# Преглед на првите 10 симулирани вредности
head(exp_samples, 10)

# Визуелизација со хистограм
hist(exp_samples, freq = TRUE, col = "lightgreen",
     main = "Симулација на експоненцијална распределба со λ = 2",
     xlab = "Вредности", ylab = "Фреквенција", breaks = 30)
```

### Вежба 4

Времето во часови потребно има експоненцијална распределба и параметар
λ=3, што значи дека просечното време на поправка е
1/3 часа (20 минути).

a) Пресметај ја веројатноста дека поправката ќе трае помеѓу 0.5 и 1.5 часа.
b) Определи ја густината на веројатност на времето на поправка за вредност од 1 час.
```{r}
#Решавајте тука
# Параметар на експоненцијалната распределба
lambda <- 3

# a) Веројатност помеѓу 0.5 и 1.5 часа
t1 <- 0.5
t2 <- 1.5
p_between <- pexp(t2, rate = lambda) - pexp(t1, rate = lambda)

# b) Густина на веројатност за t = 1 час
t <- 1
density <- dexp(t, rate = lambda)

# Печатење на резултатите
cat("a) Веројатност дека поправката ќе трае помеѓу 0.5 и 1.5 часа: ", p_between, "\n")
cat("b) Густина на веројатност за време на поправка од 1 час: ", density, "\n")

```
## Нормална (или Гаусова) распределба

Случајната променлива \(X\) има нормална (или Гаусова) распределба со параметри \(a\) (математичко очекување) и \(\sigma^2\) (варијанса), и ова се означува како \(X \sim N(a, \sigma^2)\). Густината на веројатност за нормалната распределба е дадена со формулата:

\[
p(x) = \frac{1}{\sqrt{2\pi\sigma}} e^{-\frac{(x - a)^2}{2\sigma^2}}
\]

каде што:
- \(a \in \mathbb{R}\) е средната вредност на распределбата,
- \(\sigma > 0\) е стандардната девијација, која ја одредува ширината на распределбата.

### Својства на нормалната распределба

1. **Максимум на функцијата за густина**: Густината на нормалната распределба има максимум кај \(x = a\), што ја означува средната вредност. Максимумот е:

\[
p(a) = \frac{1}{\sqrt{2\pi\sigma}}
\]

2. **Влијание на стандардната девијација**:
- Ако \(\sigma\) расте, максималната вредност на функцијата \(p(x)\) се намалува и распрснувањето на распределбата се зголемува.
- Ако \(\sigma\) опаѓа, максималната вредност на \(p(x)\) се зголемува и распределбата станува поуспоредена.

3. **Симетрија**: Густината \(p(x)\) е симетрична околу \(x = a\), што значи дека вредностите на густината за еднакви оддалечености лево и десно од \(a\) се еднакви:

\[
p(a + r) = p(a - r) = \frac{1}{\sqrt{2\pi\sigma}} e^{-\frac{r^2}{2\sigma^2}}
\]

Ова покажува дека \(x = a\) е оска на симетрија за нормалната распределба.

### Пример за симулација во R

Во R, нормалната распределба може да се симулира со функцијата `rnorm()`, која генерира случајни броеви од нормална распределба.

#### Опис на `rnorm(n, mean, sd)`:
- **`n`**: Број на случајни броеви кои треба да се генерираат.
- **`mean`**: Средната вредност \(a\) на распределбата.
- **`sd`**: Стандардната девијација \(\sigma\).

### Пример
Да се генерираат 1000 случајни броеви од нормална распределба со математичко очекување \(a = 0\) и стандардна девијација \(\sigma = 1\), и да се нацрта хистограм на симулираните вредности заедно со теоретската густина.

```{r}
# Генерирање на случајни броеви од нормална распределба
set.seed(0) # За репродуктивност
n <- 1000     # Број на симулирани точки
mean <- 0     # Математичко очекување
sd <- 1       # Стандардна девијација

# Симулирање на нормална распределба
normal_samples <- rnorm(n, mean = mean, sd = sd)

# Преглед на првите 10 симулирани вредности
head(normal_samples, 10)

# Визуелизација со хистограм и теоретска густина
hist(normal_samples, freq = FALSE, col = "lightblue",
     main = "Симулација на нормална распределба",
     xlab = "Вредности", ylab = "Густина", breaks = 30)

# Додавање на теоретската густина
curve(dnorm(x, mean = mean, sd = sd), col = "red", lwd = 2, add = TRUE)
```
### Вежба 5
Нека Х и У се случајни променливи од N(0,1) и N(1,2) соодветно.
a) Да се најде P(X< -1), P(Y<1).
b) Да се определи која е вредноста на z за која P(X<z)=0.96.
```{r}
#Решавајте тука
```

<hr>
<hr>
## Задачи
<hr>
<hr>

### Задача 1
Во една паралелка има 30 ученици, од кои: 21 не препишувале на испит, а 9 препишувале на испит. За потребите на едно истражување, случајно се избрани 14 ученици од паралелката. Нека \( X \) е бројот на избрани ученици кои не препишувале на испит.

а) а се симулираат 100 вредности на случајната променлива \( X \).
б) Да се пресметаат дескриптивните параметри за добиениот примерок и да се нацрта хистограм.
в) Од симулираниот примерок, да се определи веројатноста дека бројот на избрани ученици кои не препишувале на испит е 8, и таа веројатност да се спореди со теоретската веројатност на настанот \( P(X = 8) \).

```{r}
# Решавајте тука
# Параметри
N <- 30   # Вкупно ученици
K <- 21   # Ученици кои не препишувале
n <- 14   # Случајно избрани ученици
sample_size <- 100  # Број на симулации

# а) Симулација на 100 вредности на X
set.seed(123)  # За репродуктивност
simulated_X <- rhyper(sample_size, K, N - K, n)

# б) Дескриптивни параметри и хистограм
summary_stats <- summary(simulated_X)  # Основни статистики
mean_X <- mean(simulated_X)           # Средна вредност
sd_X <- sd(simulated_X)               # Стандардна девијација

# Хистограм
hist(simulated_X, main = "Хистограм на симулираните вредности на X",
     xlab = "Број на ученици кои не препишувале", col = "lightblue", border = "black")

# в) Веројатност P(X = 8)
observed_prob <- mean(simulated_X == 8)  # Емпириска веројатност
theoretical_prob <- dhyper(8, K, N - K, n)  # Теоретска веројатност

# Печатење на резултатите
cat("Дескриптивни статистики за симулираниот примерок:\n")
print(summary_stats)
cat("\nСредна вредност:", mean_X, "\n")
cat("Стандардна девијација:", sd_X, "\n")

cat("\nЕмпириска веројатност P(X = 8):", observed_prob, "\n")
cat("Теоретска веројатност P(X = 8):", theoretical_prob, "\n")

```
### Задача 2

Компјутерска лабораторија има 2 принтери. Принтер1 ги опслужува 40% од документите
што се печатат. Времето на принтање на овој принтер има експоненцијална распределба со
параметар 2 (2 минути во просек се принта еден документ). Принтер2 ги опслужува
останатите 60% од документите. Неговото време на принтање е со нормална распределба
N(6,2).

а) Колкава е веројатноста дека еден документ е испринтан за помалку од 1 минута?
Симулирајте 100 вредности за експериментот - принтање на 40 документи од Принтер1 и
принтање на 60 документи од Принтер2 и најдете ја приближната веројатност дека еден
документ е испринтан за помалку од 1 минута.


б) Споредете го резултатот со наоѓање на веројатноста преку некоја од готовите функции на
R
```{r}
# Решавајте тука
# а) Симулација на времето на принтање
set.seed(123)  # За репродуктивност

# Параметри
n_printer1 <- 40  # Број на документи за Принтер1
n_printer2 <- 60  # Број на документи за Принтер2
lambda <- 1/2     # Параметар за експоненцијална распределба
mu_printer2 <- 6  # Средна вредност за Принтер2
sd_printer2 <- 2  # Стандардна девијација за Принтер2

# Симулирање времиња
times_printer1 <- rexp(n_printer1, rate = lambda)
times_printer2 <- rnorm(n_printer2, mean = mu_printer2, sd = sd_printer2)

# Приближна веројатност (време < 1 мин)
prob_simulated <- mean(c(times_printer1, times_printer2) < 1)

# б) Теоретска веројатност
prob_printer1 <- pexp(1, rate = lambda)          # Принтер1
prob_printer2 <- pnorm(1, mean = mu_printer2, sd = sd_printer2)  # Принтер2

# Комбинирана теоретска веројатност
prob_theoretical <- 0.4 * prob_printer1 + 0.6 * prob_printer2

# Резултати
cat("а) Приближна веројатност од симулација:", prob_simulated, "\n")
cat("б) Теоретска веројатност:", prob_theoretical, "\n")


```
